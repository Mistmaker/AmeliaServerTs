(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{WhWH:function(e,i,t){"use strict";t.r(i),t.d(i,"ComprasModule",function(){return ae});var c=t("0IaG"),o=t("3Pt+"),n=t("ofXK"),r=t("tyNb"),l=t("PSD3"),s=t.n(l);class a{constructor(){this.itemsInvoice=[],this.isNewSupplier=!1}}class b{constructor(){this.precios=[]}}var u=t("mxd/"),d=t("2VFe"),p=t("fXoL"),C=t("epog"),h=t("bhp1");function v(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1,"Nombre requerido"),p.Xb())}function m(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," No puede colocar ese nombre "),p.Xb())}function O(e,i){if(1&e&&(p.Yb(0,"div",26),p.Bc(1,v,2,0,"div",27),p.Bc(2,m,2,0,"div",27),p.Xb()),2&e){p.hc();const e=p.uc(12);p.Jb(1),p.mc("ngIf",e.errors.required),p.Jb(1),p.mc("ngIf",e.errors.forbiddenName)}}function f(e,i){if(1&e&&(p.Yb(0,"option",31),p.Cc(1),p.Xb()),2&e){const e=i.$implicit;p.mc("value",i.index),p.Jb(1),p.Ec(" ",e.ART_NOMBRE," ")}}function g(e,i){if(1&e){const e=p.Zb();p.Yb(0,"select",28,29),p.fc("ngModelChange",function(i){return p.vc(e),p.hc().positionOfProduct=i})("change",function(){p.vc(e);const i=p.hc();return i.onChangeProductSelect(i.positionOfProduct)}),p.Bc(2,f,2,2,"option",30),p.Xb()}if(2&e){const e=p.hc();p.mc("ngModel",e.positionOfProduct),p.Jb(2),p.mc("ngForOf",e.productsList)}}function P(e,i){1&e&&(p.Yb(0,"label"),p.Cc(1,"Precio del producto *"),p.Xb())}function E(e,i){if(1&e){const e=p.Zb();p.Yb(0,"input",35,36),p.fc("ngModelChange",function(i){return p.vc(e),p.hc(2).invoiceDetail.DETFACPRO_COSTO=i}),p.Xb()}if(2&e){const e=p.hc(2);p.mc("ngModel",e.invoiceDetail.DETFACPRO_COSTO)}}function R(e,i){1&e&&(p.Yb(0,"label"),p.Cc(1,"Seleccione un precio *"),p.Xb())}function A(e,i){if(1&e&&(p.Yb(0,"option",31),p.Cc(1),p.Xb()),2&e){const e=i.$implicit;p.mc("value",i.index),p.Jb(1),p.Fc(" $",e.ARTPRE_PRECIO," | ",e.UNI_CODIGO," ")}}function D(e,i){if(1&e){const e=p.Zb();p.Yb(0,"select",37,38),p.fc("ngModelChange",function(i){return p.vc(e),p.hc(2).positionOfPrice=i})("change",function(){p.vc(e);const i=p.uc(1);return p.hc(2).onChangeSelect(i.value)}),p.Bc(2,A,2,3,"option",30),p.Xb()}if(2&e){const e=p.hc(2);p.mc("ngModel",e.positionOfPrice),p.Jb(2),p.mc("ngForOf",e.pricesList)}}function I(e,i){if(1&e&&(p.Yb(0,"div",32),p.Yb(1,"div",15),p.Bc(2,P,2,0,"label",27),p.Bc(3,E,2,1,"input",33),p.Bc(4,R,2,0,"label",27),p.Bc(5,D,3,2,"select",34),p.Xb(),p.Xb()),2&e){const e=p.hc();p.Jb(2),p.mc("ngIf",!e.showListPrice),p.Jb(1),p.mc("ngIf",!e.showListPrice),p.Jb(1),p.mc("ngIf",e.showListPrice),p.Jb(1),p.mc("ngIf",e.showListPrice)}}function T(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1,"Se debe ingresar un valor"),p.Xb())}function X(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1,"Debe tener m\xednimo 1 articulo"),p.Xb())}function Y(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," No puede colocar ese valor "),p.Xb())}function F(e,i){if(1&e&&(p.Yb(0,"div",26),p.Bc(1,T,2,0,"div",27),p.Bc(2,X,2,0,"div",27),p.Bc(3,Y,2,0,"div",27),p.Xb()),2&e){p.hc();const e=p.uc(24);p.Jb(1),p.mc("ngIf",e.errors.required),p.Jb(1),p.mc("ngIf",e.errors.min),p.Jb(1),p.mc("ngIf",e.errors.forbiddenName)}}function _(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Se debe ingresar un valor "),p.Xb())}function S(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Puede tener como m\xednimo $0.00 de descuento "),p.Xb())}function N(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," No puede colocar ese valor "),p.Xb())}function M(e,i){if(1&e&&(p.Yb(0,"div",26),p.Bc(1,_,2,0,"div",27),p.Bc(2,S,2,0,"div",27),p.Bc(3,N,2,0,"div",27),p.Xb()),2&e){p.hc();const e=p.uc(32);p.Jb(1),p.mc("ngIf",e.errors.required),p.Jb(1),p.mc("ngIf",e.errors.min),p.Jb(1),p.mc("ngIf",e.errors.forbiddenName)}}function J(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Se debe ingresar un valor "),p.Xb())}function V(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Puede tener como m\xednimo 0% de descuento "),p.Xb())}function B(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Puede tener como m\xe1ximo 100% de descuento "),p.Xb())}function L(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," No puede colocar ese valor "),p.Xb())}function x(e,i){if(1&e&&(p.Yb(0,"div",26),p.Bc(1,J,2,0,"div",27),p.Bc(2,V,2,0,"div",27),p.Bc(3,B,2,0,"div",27),p.Bc(4,L,2,0,"div",27),p.Xb()),2&e){const e=p.hc(),i=p.uc(39);p.Jb(1),p.mc("ngIf",i.errors.required),p.Jb(1),p.mc("ngIf",i.errors.min),p.Jb(1),p.mc("ngIf",i.errors.max),p.Jb(1),p.mc("ngIf",e.discount.errors.forbiddenName)}}let y=(()=>{class e{constructor(e,i,t,c){this.dialogRef=e,this.data=i,this.productService=t,this.pricesService=c,this.query="",this.productsList=[],this.positionOfProduct=-1,this.invoiceDetail=new b,this.showListPrice=!1,this.positionOfPrice=-1,this.price=new d.a,this.pricesList=[],this.productSelected=!1,this.showListPrice=i.showListPrice}ngOnInit(){this.invoiceDetail.DETFACPRO_PORDES=0,this.invoiceDetail.DETFACPRO_VALDES=0}onNoClick(){this.dialogRef.close()}onChangeSelect(e){this.positionOfPrice=e,this.price=this.pricesList[e]}onChangeProductSelect(e){this.positionOfProduct=e,this.query=this.productsList[e].ART_NOMBRE,this.showListPrice&&this.pricesService.getPreciosPorProducto(this.productsList[e].ART_CODIGO).subscribe(e=>{this.pricesList=e}),this.productSelected=!0}searchProduct(e){this.productSelected=!1,this.positionOfProduct=-1,setTimeout(()=>{this.productService.getProductoByName(this.query).subscribe(e=>{this.productsList=e})},500)}addProduct(e){e.invalid||(this.invoiceDetail.DETFACPRO_DESCRIPCION=this.productsList[this.positionOfProduct].ART_NOMBRE,this.invoiceDetail.DETFACPRO_CODIGO=this.productsList[this.positionOfProduct].ART_CODIGO,this.showListPrice&&(this.invoiceDetail.DETFACPRO_COSTO=this.price.ARTPRE_PRECIO),this.invoiceDetail.DETFACPRO_TRIBICE=this.productsList[this.positionOfProduct].ART_TRIBUTAICE,this.invoiceDetail.DETFACPRO_ICE=this.productsList[this.positionOfProduct].ART_VALORICE,this.invoiceDetail.tributaIva=this.productsList[this.positionOfProduct].ART_TRIBUTAIVA,this.invoiceDetail.DETFACPRO_TOTAL=this.getTotal(),this.invoiceDetail.precios=this.pricesList,this.dialogRef.close(this.invoiceDetail))}getTotal(){let e=this.invoiceDetail.DETFACPRO_COSTO*this.invoiceDetail.DETFACPRO_CANTIDAD;return e-e*(parseFloat(this.invoiceDetail.DETFACPRO_PORDES.toString())/100)}discountValueToPercent(){let e=parseFloat(this.invoiceDetail.DETFACPRO_VALDES.toString()),i=parseFloat(this.invoiceDetail.DETFACPRO_COSTO.toString())*this.invoiceDetail.DETFACPRO_CANTIDAD;this.invoiceDetail.DETFACPRO_PORDES=parseFloat((e/i*100).toFixed(6))}discountPercentToValue(){let e=parseFloat(this.invoiceDetail.DETFACPRO_PORDES.toString()),i=parseFloat(this.invoiceDetail.DETFACPRO_COSTO.toString())*this.invoiceDetail.DETFACPRO_CANTIDAD;this.invoiceDetail.DETFACPRO_VALDES=parseFloat((i*(e/100)).toFixed(6))}}return e.\u0275fac=function(i){return new(i||e)(p.Tb(c.g),p.Tb(c.a),p.Tb(C.a),p.Tb(h.a))},e.\u0275cmp=p.Nb({type:e,selectors:[["app-crear-producto"]],decls:46,vars:11,consts:[[1,"d-flex","justify-content-between"],["mat-dialog-title","","id","exampleModalLabel",1,""],["type","button",1,"close",3,"click"],["aria-hidden","true"],["mat-dialog-content","",1,"mt-4",2,"min-height","max-content",3,"ngSubmit"],["f","ngForm"],["type","text","name","searchProduct","placeholder","Nombre del producto","required","","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange","keyup"],["productName","ngModel"],["class","alert bg-warning",4,"ngIf"],[2,"min-height","100px"],["name","selectedProduct","multiple","","class","form-control",3,"ngModel","ngModelChange","change",4,"ngIf"],["class","col-sm-12",4,"ngIf"],[1,"form-group","mt-2"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["name","count","placeholder","0","type","number","min","1","step","0.000001","required","",1,"form-control",3,"ngModel","ngModelChange"],["count","ngModel"],[1,"row","col-md-6"],["name","discountValue","placeholder","0","type","number","min","0","step","0.01","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["discountValue","ngModel"],["name","discountPercent","placeholder","0","type","number","min","0","max","100","required","",1,"form-control",3,"ngModel","defaultValue","ngModelChange","change"],["discountPercent","ngModel"],["mat-dialog-actions","",1,"d-flex","justify-content-end","mt-4"],["type","button",1,"btn","btn-secondary",2,"margin-right","1rem",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"alert","bg-warning"],[4,"ngIf"],["name","selectedProduct","multiple","",1,"form-control",3,"ngModel","ngModelChange","change"],["selectedProduct",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"col-sm-12"],["name","price","placeholder","0","type","number","class","form-control","step","0.000001","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","priceProduct","class","form-control",3,"ngModel","ngModelChange","change",4,"ngIf"],["name","price","placeholder","0","type","number","step","0.000001","required","",1,"form-control",3,"ngModel","ngModelChange"],["price","ngModel"],["name","priceProduct",1,"form-control",3,"ngModel","ngModelChange","change"],["priceProduct",""]],template:function(e,i){if(1&e){const e=p.Zb();p.Yb(0,"div",0),p.Yb(1,"h5",1),p.Cc(2,"Nuevo Producto"),p.Xb(),p.Yb(3,"button",2),p.fc("click",function(){return i.onNoClick()}),p.Yb(4,"span",3),p.Cc(5,"\xd7"),p.Xb(),p.Xb(),p.Xb(),p.Yb(6,"form",4,5),p.fc("ngSubmit",function(){p.vc(e);const t=p.uc(7);return t.form.valid&&i.addProduct(t)}),p.Yb(8,"div"),p.Yb(9,"label"),p.Cc(10,"Nombre del producto*"),p.Xb(),p.Yb(11,"input",6,7),p.fc("ngModelChange",function(e){return i.query=e})("keyup",function(e){return i.searchProduct(e)}),p.Xb(),p.Bc(13,O,3,2,"div",8),p.Yb(14,"div",9),p.Bc(15,g,3,2,"select",10),p.Xb(),p.Xb(),p.Bc(16,I,6,4,"div",11),p.Yb(17,"div",12),p.Yb(18,"div",13),p.Yb(19,"div",14),p.Yb(20,"div",15),p.Yb(21,"label"),p.Cc(22,"Cantidad*"),p.Xb(),p.Yb(23,"input",16,17),p.fc("ngModelChange",function(e){return i.invoiceDetail.DETFACPRO_CANTIDAD=e}),p.Xb(),p.Bc(25,F,4,3,"div",8),p.Xb(),p.Xb(),p.Yb(26,"div",18),p.Yb(27,"div",14),p.Yb(28,"div",15),p.Yb(29,"label"),p.Cc(30,"Descuento ($ valor)"),p.Xb(),p.Yb(31,"input",19,20),p.fc("ngModelChange",function(e){return i.invoiceDetail.DETFACPRO_VALDES=e})("change",function(){return i.discountValueToPercent()}),p.Xb(),p.Bc(33,M,4,3,"div",8),p.Xb(),p.Xb(),p.Yb(34,"div",14),p.Yb(35,"div",15),p.Yb(36,"label"),p.Cc(37,"Descuento (% porcentaje)"),p.Xb(),p.Yb(38,"input",21,22),p.fc("ngModelChange",function(e){return i.invoiceDetail.DETFACPRO_PORDES=e})("change",function(){return i.discountPercentToValue()}),p.Xb(),p.Bc(40,x,5,4,"div",8),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(41,"div",23),p.Yb(42,"button",24),p.fc("click",function(){return i.onNoClick()}),p.Cc(43," Cerrar "),p.Xb(),p.Yb(44,"button",25),p.Cc(45,"A\xf1adir producto"),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.uc(7),t=p.uc(12),c=p.uc(24),o=p.uc(32),n=p.uc(39);p.Jb(11),p.mc("ngModel",i.query),p.Jb(2),p.mc("ngIf",e.submitted&&t.invalid),p.Jb(2),p.mc("ngIf",i.productsList.length>0&&(null==i.productsList[i.positionOfProduct]?null:i.productsList[i.positionOfProduct].ART_NOMBRE)!=i.query),p.Jb(1),p.mc("ngIf",i.productSelected),p.Jb(7),p.mc("ngModel",i.invoiceDetail.DETFACPRO_CANTIDAD),p.Jb(2),p.mc("ngIf",e.submitted&&c.invalid),p.Jb(6),p.mc("ngModel",i.invoiceDetail.DETFACPRO_VALDES),p.Jb(2),p.mc("ngIf",e.submitted&&o.invalid),p.Jb(5),p.mc("ngModel",i.invoiceDetail.DETFACPRO_PORDES)("defaultValue",0),p.Jb(2),p.mc("ngIf",e.submitted&&n.invalid)}},directives:[o.n,o.f,o.g,o.a,o.k,o.e,o.h,n.k,o.j,o.m,n.j,o.i,o.o,o.l],styles:[""]}),e})();var w=t("HspK"),k=t("p7vj"),q=t("cxbk"),U=t("tk/3");let G=(()=>{class e{constructor(e){this.http=e,this.ruta=q.a}postFacturaProveedor(e){return this.http.post(`${this.ruta}/api/facturas/factura-proveedor`,e)}}return e.\u0275fac=function(i){return new(i||e)(p.cc(U.a))},e.\u0275prov=p.Pb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function $(e,i){if(1&e&&(p.Yb(0,"option",54),p.Cc(1),p.Xb()),2&e){const e=i.$implicit;p.mc("value",e.ticli_codigo),p.Jb(1),p.Ec(" ",e.ticli_nombre," ")}}function j(e,i){1&e&&(p.Yb(0,"div",55),p.Cc(1,"Existente"),p.Xb())}function Z(e,i){1&e&&(p.Yb(0,"div",55),p.Cc(1,"Nuevo"),p.Xb())}function z(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Nombre requeridos "),p.Xb())}function H(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Debe tener m\xednimo 4 letras "),p.Xb())}function K(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," No puede colocar ese nombre "),p.Xb())}function Q(e,i){if(1&e&&(p.Yb(0,"div",56),p.Bc(1,z,2,0,"div",57),p.Bc(2,H,2,0,"div",57),p.Bc(3,K,2,0,"div",57),p.Xb()),2&e){p.hc();const e=p.uc(42);p.Jb(1),p.mc("ngIf",e.errors.required),p.Jb(1),p.mc("ngIf",e.errors.minlength),p.Jb(1),p.mc("ngIf",e.errors.forbiddenName)}}function W(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Nombre requeridos "),p.Xb())}function ee(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," Debe tener m\xednimo 4 letras "),p.Xb())}function ie(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," No puede colocar ese nombre "),p.Xb())}function te(e,i){if(1&e&&(p.Yb(0,"div",56),p.Bc(1,W,2,0,"div",57),p.Bc(2,ee,2,0,"div",57),p.Bc(3,ie,2,0,"div",57),p.Xb()),2&e){p.hc();const e=p.uc(49);p.Jb(1),p.mc("ngIf",e.errors.required),p.Jb(1),p.mc("ngIf",e.errors.minlength),p.Jb(1),p.mc("ngIf",e.errors.forbiddenName)}}function ce(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," N\xfamero de factura requerido "),p.Xb())}function oe(e,i){1&e&&(p.Yb(0,"div"),p.Cc(1," No puede colocar ese valor "),p.Xb())}function ne(e,i){if(1&e&&(p.Yb(0,"div",56),p.Bc(1,ce,2,0,"div",57),p.Bc(2,oe,2,0,"div",57),p.Xb()),2&e){p.hc();const e=p.uc(72);p.Jb(1),p.mc("ngIf",e.errors.required),p.Jb(1),p.mc("ngIf",e.errors.forbiddenName)}}function re(e,i){if(1&e){const e=p.Zb();p.Yb(0,"tr"),p.Yb(1,"td"),p.Yb(2,"input",58),p.fc("ngModelChange",function(e){return i.$implicit.DETFACPRO_CANTIDAD=e})("change",function(){p.vc(e);const t=i.index;return p.hc().calcularTotalPorFila(t)}),p.Xb(),p.Xb(),p.Yb(3,"td"),p.Cc(4),p.Xb(),p.Yb(5,"td"),p.Cc(6),p.Xb(),p.Yb(7,"td"),p.Yb(8,"input",58),p.fc("ngModelChange",function(e){return i.$implicit.DETFACPRO_COSTO=e})("change",function(){p.vc(e);const t=i.index;return p.hc().calcularTotalPorFila(t)}),p.Xb(),p.Xb(),p.Yb(9,"td"),p.Yb(10,"input",59),p.fc("ngModelChange",function(e){return i.$implicit.DETFACPRO_VALDES=e})("change",function(){p.vc(e);const t=i.index;return p.hc().calcularTotalPorFila(t,"value")}),p.Xb(),p.Xb(),p.Yb(11,"td"),p.Yb(12,"input",60),p.fc("ngModelChange",function(e){return i.$implicit.DETFACPRO_PORDES=e})("change",function(){p.vc(e);const t=i.index;return p.hc().calcularTotalPorFila(t,"percent")}),p.Xb(),p.Xb(),p.Yb(13,"td"),p.Cc(14),p.Xb(),p.Yb(15,"td"),p.Yb(16,"button",61),p.fc("click",function(){p.vc(e);const t=i.index;return p.hc().removeProduct(t)}),p.Ub(17,"i",62),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=i.$implicit,t=i.index;p.Jb(2),p.pc("name","",e.DETFACPRO_CANTIDAD,"",t,""),p.mc("ngModel",e.DETFACPRO_CANTIDAD)("value",e.DETFACPRO_CANTIDAD),p.Jb(2),p.Dc(e.DETFACPRO_CODIGO),p.Jb(2),p.Dc(e.DETFACPRO_DESCRIPCION),p.Jb(2),p.pc("name","",e.DETFACPRO_COSTO,"",t,""),p.mc("ngModel",e.DETFACPRO_COSTO)("value",e.DETFACPRO_COSTO),p.Jb(2),p.pc("name","",e.DETFACPRO_VALDES,"value",t,""),p.mc("ngModel",e.DETFACPRO_VALDES)("value",e.DETFACPRO_VALDES),p.Jb(2),p.pc("name","",e.DETFACPRO_PORDES,"percent",t,""),p.mc("ngModel",e.DETFACPRO_PORDES)("value",e.DETFACPRO_PORDES),p.Jb(2),p.Dc(e.DETFACPRO_TOTAL.toFixed(2))}}const le=[{path:"",component:(()=>{class e{constructor(e,i,t,c){this.supplierService=e,this.typeClientService=i,this.facturasService=t,this.dialog=c,this.supplier=new u.b,this.typeClient=[],this.invoice=new a,this.isNewSupplier=!1,this.subtotal=0}ngOnInit(){this.typeClientService.getTipos().subscribe(e=>{this.typeClient=e,this.supplier.PRO_TIPOIDE=this.typeClient[0].ticli_codigo}),this.invoice.ENCFACPRO_BASEIVA=0,this.invoice.ENCFACPRO_BASECERO=0,this.invoice.ENCFACPRO_BASENOOBJIVA=0,this.invoice.ENCFACPRO_PORCEIVA=0,this.invoice.ENCFACPRO_PORCEDES=0,this.invoice.ENCFACPRO_VALORICE=0,this.invoice.ENCFACPRO_VALORIVA=0,this.invoice.ENCFACPRO_TOTAL=0}toggleCheckBox(){this.isNewSupplier=!this.isNewSupplier}searchSupplier(){return this.supplier.PRO_CODIGO?10!==this.supplier.PRO_CODIGO.length&&13!==this.supplier.PRO_CODIGO.length?s.a.fire("Advertencia","C\xe9dula o RUC deben tener 10 o 13 d\xedgitos","warning"):void(this.isNewSupplier?this.searchDataOnline():this.supplierService.getProveedor(this.supplier.PRO_CODIGO).subscribe(e=>{this.supplier=e},e=>{})):s.a.fire("Advertencia","Ingrese un n\xfamero de identificaci\xf3n (Ruc)","warning")}searchDataOnline(){10===this.supplier.PRO_CODIGO.length&&this.supplierService.getProveedorCedula(this.supplier.PRO_CODIGO).subscribe(e=>{this.formatData(e.result[0],"C")}),13===this.supplier.PRO_CODIGO.length&&this.supplierService.getProveedorSri(this.supplier.PRO_CODIGO).subscribe(e=>{this.formatData(e,"R")},e=>{this.supplierService.getProveedorSriAlt(this.supplier.PRO_CODIGO).subscribe(e=>{this.formatData(e,"R")})})}formatData(e,i){"C"===i&&e.identity&&(this.supplier.PRO_NOMBRE=e.name,this.supplier.PRO_NOMBREC=e.name,this.supplier.PRO_DIRECCION1=e.residence+" "+e.streets+" "+e.homenumber),"R"===i&&(e["RUC:"]&&(this.supplier.PRO_NOMBRE=e["Raz\xf3n Social:"],this.supplier.PRO_NOMBREC=""!==e["Nombre Comercial:"]?e["Nombre Comercial:"]:e["Raz\xf3n Social:"],this.supplier.PRO_CLASECONTRIBUYENTE=e["Tipo de Contribuyente"],this.supplier.PRO_FECINIACTIVIDADES=this.formatDate(e["Fecha de inicio de actividades"]),this.supplier.PRO_FECCESACTIVIDADES=this.formatDate(e["Fecha de cese de actividades"]),this.supplier.PRO_FECREIACTIVIDADES=this.formatDate(e["Fecha reinicio de actividades"]),this.supplier.PRO_FECACTUALIZACION=this.formatDate(e["Fecha actualizaci\xf3n"])),e.NUMERO_RUC&&(this.supplier.PRO_NOMBRE=e["Raz\xf3n Social:"],this.supplier.PRO_NOMBREC=""!==e["Nombre Comercial:"]?e["Nombre Comercial:"]:e["Raz\xf3n Social:"])),this.supplier.PRO_FECHACONSULTA=(new Date).toDateString()}formatDate(e){let i=e;i=i.replace(/\r\n|\r|\n|\t|\s/gi,"");let t=i.split("-");return`${t[2]}-${t[1]}-${t[0]}`}onChangeSelect(e){}saveInvoice(e){e.invalid||(this.isNewSupplier&&(this.supplier.PRO_FECINIACTIVIDADES&&this.supplier.PRO_FECINIACTIVIDADES.includes("undefined")&&(this.supplier.PRO_FECINIACTIVIDADES=null),this.supplier.PRO_FECCESACTIVIDADES&&this.supplier.PRO_FECCESACTIVIDADES.includes("undefined")&&(this.supplier.PRO_FECCESACTIVIDADES=null),this.supplier.PRO_FECREIACTIVIDADES&&this.supplier.PRO_FECREIACTIVIDADES.includes("undefined")&&(this.supplier.PRO_FECREIACTIVIDADES=null),this.supplier.PRO_FECACTUALIZACION&&this.supplier.PRO_FECACTUALIZACION.includes("undefined")&&(this.supplier.PRO_FECACTUALIZACION=null),this.invoice.isNewSupplier=this.isNewSupplier,this.invoice.supplier=this.supplier),this.invoice.ENCFACPRO_FECHAEMISION=new Date,this.invoice.PRO_CODIGO=this.supplier.PRO_CODIGO,this.invoice.ENCFACPRO_CORREO=this.supplier.PRO_CORREO,this.facturasService.postFacturaProveedor(this.invoice).subscribe(e=>{s.a.fire("\xc9xito","Se creo la factura con \xe9xito","success")},e=>{s.a.fire("Error",e.error.msg,"error")}))}openDialog(){this.dialog.open(y,{panelClass:"dialog-responsive",data:{showListPrice:!1}}).afterClosed().subscribe(e=>{e&&(this.invoice.itemsInvoice.push(e),this.calcularValoresTotales())})}addProduct(){this.invoice.itemsInvoice.push(new b)}removeProduct(e){this.invoice.itemsInvoice.splice(e,1)}onChangeSelectPrice(e,i){this.invoice.itemsInvoice[e].DETFACPRO_COSTO=i,this.calcularTotalPorFila(e,"none"),this.calcularValoresTotales()}calcularTotalPorFila(e,i){"value"===i?this.discountValueToPercent(e):"percent"===i&&this.discountPercentToValue(e),this.invoice.itemsInvoice[e].DETFACPRO_TOTAL=this.getTotalItem(this.invoice.itemsInvoice[e]),this.calcularValoresTotales()}getTotalItem(e){let i=e.DETFACPRO_COSTO*e.DETFACPRO_CANTIDAD;return i-i*(parseFloat(e.DETFACPRO_PORDES.toString())/100)}discountValueToPercent(e){let i=parseFloat(this.invoice.itemsInvoice[e].DETFACPRO_VALDES.toString()),t=parseFloat(this.invoice.itemsInvoice[e].DETFACPRO_COSTO.toString())*this.invoice.itemsInvoice[e].DETFACPRO_CANTIDAD;this.invoice.itemsInvoice[e].DETFACPRO_PORDES=parseFloat((i/t*100).toFixed(6))}discountPercentToValue(e){let i=parseFloat(this.invoice.itemsInvoice[e].DETFACPRO_PORDES.toString()),t=parseFloat(this.invoice.itemsInvoice[e].DETFACPRO_COSTO.toString())*this.invoice.itemsInvoice[e].DETFACPRO_CANTIDAD;this.invoice.itemsInvoice[e].DETFACPRO_VALDES=parseFloat((t*(i/100)).toFixed(6))}calcularValoresTotales(){this.subtotal=this.calculateSubtotal(),this.invoice.ENCFACPRO_BASEIVA=this.calculateSubtotalIva(),this.invoice.ENCFACPRO_BASECERO=this.calculateSubtotalNoIva(),this.invoice.ENCFACPRO_BASENOOBJIVA=0,this.invoice.ENCFACPRO_PORCEIVA=0,this.invoice.ENCFACPRO_PORCEDES=this.calculateDescuento(),this.invoice.ENCFACPRO_VALORICE=this.calculateValorIce(),this.invoice.ENCFACPRO_VALORIVA=this.calculateIva12P(),this.invoice.ENCFACPRO_TOTAL=this.calculateValorTotal()}calculateSubtotal(){let e=0;return this.invoice.itemsInvoice.forEach(i=>{e+=i.DETFACPRO_TOTAL}),e}calculateSubtotalIva(){let e=0;return this.invoice.itemsInvoice.forEach(i=>{"S"===i.tributaIva.toUpperCase()&&(e+=.12*i.DETFACPRO_TOTAL)}),parseFloat(e.toFixed(6))}calculateSubtotalNoIva(){let e=0;return this.invoice.itemsInvoice.forEach(i=>{"N"===i.tributaIva.toUpperCase()&&(e+=i.DETFACPRO_TOTAL)}),parseFloat(e.toFixed(6))}calculateDescuento(){let e=0;return this.invoice.itemsInvoice.forEach(i=>{e+=i.DETFACPRO_VALDES}),parseFloat(e.toFixed(6))}calculateValorIce(){let e=0;return this.invoice.itemsInvoice.forEach(i=>{"S"===i.DETFACPRO_TRIBICE.toUpperCase()&&(e+=i.DETFACPRO_ICE*i.DETFACPRO_CANTIDAD)}),parseFloat(e.toFixed(6))}calculateIva12P(){return parseFloat((.12*(this.invoice.ENCFACPRO_BASEIVA+this.invoice.ENCFACPRO_VALORICE)).toFixed(6))}calculateValorTotal(){return parseFloat((this.subtotal+this.invoice.ENCFACPRO_VALORICE+this.invoice.ENCFACPRO_VALORIVA).toFixed(6))}}return e.\u0275fac=function(i){return new(i||e)(p.Tb(w.a),p.Tb(k.a),p.Tb(G),p.Tb(c.b))},e.\u0275cmp=p.Nb({type:e,selectors:[["app-factura"]],decls:170,vars:25,consts:[[1,""],[1,"col-md-12"],[1,"card"],[1,"card-body"],[3,"ngSubmit"],["f","ngForm"],[1,"card-header"],[1,"form-group"],[1,"col-sm-12","col-md-3","mt-1","mb-1","d-flex","align-items-center"],[1,"form-group","form-check"],["name","isNewSupplier","type","checkbox","id","newSupplierCK",1,"form-check-input",2,"cursor","pointer",3,"checked","change"],["for","newSupplierCK",1,"form-check-label"],[1,"row"],[1,"col-sm-12","col-md-3"],["name","typeTaxpayer",1,"form-control",3,"ngModel","ngModelChange","change"],["typeTaxpayer",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-10","col-md-10"],["type","text","name","proCodigo","placeholder","9999999999","maxlength","13","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-sm-2","col-md-2"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"click"],[1,"fas","fa-search"],["style","margin-left: 0.5rem;",4,"ngIf"],[1,"col-md-6"],["name","name","placeholder","Nombre proveedor","type","text","minlength","4","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],["class","alert bg-warning",4,"ngIf"],["name","comercialName","placeholder","Nombre Comercial del Proveedor","type","text","minlength","4","required","",1,"form-control",3,"ngModel","ngModelChange"],["comercialName","ngModel"],[1,"col-md-4"],["name","address","placeholder","Direcci\xf3n","type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["name","phone","placeholder","Tel\xe9fono","type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["name","address","placeholder","Email","type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["name","invoiceNumber","placeholder","000000026","type","text","required","",1,"form-control",3,"ngModel","ngModelChange"],["invoiceNumber","ngModel"],[1,"card","mt-2"],[1,"d-flex","col-12","justify-content-end"],["type","button",1,"btn","btn-primary","d-flex","align-items-center","justify-content-center",3,"click"],[1,"fas","fa-plus","mr-1"],[1,"table-responsive","mt-2"],[1,"table","table-hover","animated","fadein","faster"],[1,"text-primary"],[4,"ngFor","ngForOf"],[1,"row","mt-1"],[1,"col-md-8"],["name","observation","placeholder","Observaci\xf3n...","type","text","minlength","4",1,"form-control"],[1,"col-md-4","d-flex","flex-column"],[1,"row","col"],[1,"col-8","d-flex","justify-content-end"],[1,"col-4"],[1,"col-8","d-flex","justify-content-end","font-weight-bolder"],[1,"form-group","text-center","mb-2","mt-2"],["type","submit",1,"btn","btn-primary","w-50"],[1,"fas","fa-save"],[3,"value"],[2,"margin-left","0.5rem"],[1,"alert","bg-warning"],[4,"ngIf"],["placeholder","1","type","number","min","1","required","",1,"form-control",3,"name","ngModel","value","ngModelChange","change"],["placeholder","0","type","number","min","0","required","",1,"form-control",3,"name","ngModel","value","ngModelChange","change"],["placeholder","0","type","number","min","0","max","100","required","",1,"form-control",3,"name","ngModel","value","ngModelChange","change"],["type","button",1,"btn","btn-danger","mr-1",3,"click"],[1,"fas","fa-trash-alt"]],template:function(e,i){if(1&e){const e=p.Zb();p.Yb(0,"div",0),p.Yb(1,"div",1),p.Yb(2,"div",2),p.Yb(3,"div",3),p.Yb(4,"form",4,5),p.fc("ngSubmit",function(){p.vc(e);const t=p.uc(5);return t.form.valid&&i.saveInvoice(t)}),p.Yb(6,"div",2),p.Yb(7,"div",6),p.Cc(8,"Proveedor"),p.Xb(),p.Yb(9,"div",3),p.Yb(10,"div",7),p.Yb(11,"div",8),p.Yb(12,"div",9),p.Yb(13,"input",10),p.fc("change",function(){return i.toggleCheckBox()}),p.Xb(),p.Yb(14,"label",11),p.Cc(15," Nuevo proveedor "),p.Xb(),p.Xb(),p.Xb(),p.Yb(16,"div",12),p.Yb(17,"div",13),p.Yb(18,"div",7),p.Yb(19,"label"),p.Cc(20,"Tipo de Identificaci\xf3n *"),p.Xb(),p.Yb(21,"select",14,15),p.fc("ngModelChange",function(e){return i.supplier.PRO_TIPOIDE=e})("change",function(){p.vc(e);const t=p.uc(22);return i.onChangeSelect(t.value)}),p.Bc(23,$,2,2,"option",16),p.Xb(),p.Xb(),p.Xb(),p.Yb(24,"div",13),p.Yb(25,"label"),p.Cc(26,"Ruc *"),p.Xb(),p.Yb(27,"div",12),p.Yb(28,"div",17),p.Yb(29,"input",18),p.fc("ngModelChange",function(e){return i.supplier.PRO_CODIGO=e}),p.Xb(),p.Xb(),p.Yb(30,"div",19),p.Yb(31,"button",20),p.fc("click",function(){return i.searchSupplier()}),p.Ub(32,"i",21),p.Bc(33,j,2,0,"div",22),p.Bc(34,Z,2,0,"div",22),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(35,"div",7),p.Yb(36,"div",12),p.Yb(37,"div",23),p.Yb(38,"div",7),p.Yb(39,"label"),p.Cc(40,"Nombre *"),p.Xb(),p.Yb(41,"input",24,25),p.fc("ngModelChange",function(e){return i.supplier.PRO_NOMBRE=e}),p.Xb(),p.Bc(43,Q,4,3,"div",26),p.Xb(),p.Xb(),p.Yb(44,"div",23),p.Yb(45,"div",7),p.Yb(46,"label"),p.Cc(47,"Nombre Comercial *"),p.Xb(),p.Yb(48,"input",27,28),p.fc("ngModelChange",function(e){return i.supplier.PRO_NOMBREC=e}),p.Xb(),p.Bc(50,te,4,3,"div",26),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(51,"div",7),p.Yb(52,"div",12),p.Yb(53,"div",29),p.Yb(54,"div",7),p.Yb(55,"label"),p.Cc(56,"Direcci\xf3n"),p.Xb(),p.Yb(57,"input",30),p.fc("ngModelChange",function(e){return i.supplier.PRO_DIRECCION1=e}),p.Xb(),p.Xb(),p.Xb(),p.Yb(58,"div",29),p.Yb(59,"div",7),p.Yb(60,"label"),p.Cc(61,"Tel\xe9fono"),p.Xb(),p.Yb(62,"input",31),p.fc("ngModelChange",function(e){return i.supplier.PRO_TELEFONO1=e}),p.Xb(),p.Xb(),p.Xb(),p.Yb(63,"div",29),p.Yb(64,"div",7),p.Yb(65,"label"),p.Cc(66,"Email"),p.Xb(),p.Yb(67,"input",32),p.fc("ngModelChange",function(e){return i.supplier.PRO_CORREO=e}),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(68,"div",7),p.Yb(69,"label"),p.Cc(70,"N\xfamero de factura *"),p.Xb(),p.Yb(71,"input",33,34),p.fc("ngModelChange",function(e){return i.invoice.ENCFACPRO_NUMERO=e}),p.Xb(),p.Bc(73,ne,3,2,"div",26),p.Xb(),p.Xb(),p.Xb(),p.Yb(74,"div",35),p.Yb(75,"div",6),p.Cc(76,"Producto"),p.Xb(),p.Yb(77,"div",3),p.Yb(78,"div",7),p.Yb(79,"div",36),p.Yb(80,"button",37),p.fc("click",function(){return i.openDialog()}),p.Ub(81,"i",38),p.Cc(82," A\xf1adir "),p.Xb(),p.Xb(),p.Xb(),p.Yb(83,"div",39),p.Yb(84,"table",40),p.Yb(85,"thead",41),p.Yb(86,"th"),p.Cc(87,"Cantidad *"),p.Xb(),p.Yb(88,"th"),p.Cc(89,"C\xf3digo"),p.Xb(),p.Yb(90,"th"),p.Cc(91,"Descripci\xf3n"),p.Xb(),p.Yb(92,"th"),p.Cc(93,"Precio"),p.Xb(),p.Yb(94,"th"),p.Cc(95,"Descuento $"),p.Xb(),p.Yb(96,"th"),p.Cc(97,"Descuento %"),p.Xb(),p.Yb(98,"th"),p.Cc(99,"Total"),p.Xb(),p.Yb(100,"th"),p.Cc(101,"Acci\xf3n"),p.Xb(),p.Xb(),p.Yb(102,"tbody"),p.Bc(103,re,18,19,"tr",42),p.Xb(),p.Xb(),p.Xb(),p.Yb(104,"div",43),p.Yb(105,"div",44),p.Yb(106,"div",7),p.Yb(107,"label"),p.Cc(108,"Observaci\xf3n"),p.Xb(),p.Ub(109,"textarea",45),p.Xb(),p.Xb(),p.Yb(110,"div",46),p.Yb(111,"div",47),p.Yb(112,"p",48),p.Cc(113," SubTotal Sin Impuesto "),p.Xb(),p.Yb(114,"p",49),p.Cc(115),p.Xb(),p.Xb(),p.Yb(116,"div",47),p.Yb(117,"p",48),p.Cc(118,"SubTotal 12%"),p.Xb(),p.Yb(119,"p",49),p.Cc(120),p.Xb(),p.Xb(),p.Yb(121,"div",47),p.Yb(122,"p",48),p.Cc(123,"SubTotal 0%"),p.Xb(),p.Yb(124,"p",49),p.Cc(125),p.Xb(),p.Xb(),p.Yb(126,"div",47),p.Yb(127,"p",48),p.Cc(128," SubTotal No Objeto IVA "),p.Xb(),p.Yb(129,"p",49),p.Cc(130),p.Xb(),p.Xb(),p.Yb(131,"div",47),p.Yb(132,"p",48),p.Cc(133," SubTotal Exento IVA "),p.Xb(),p.Yb(134,"p",49),p.Cc(135),p.Xb(),p.Xb(),p.Yb(136,"div",47),p.Yb(137,"p",48),p.Cc(138,"Descuento"),p.Xb(),p.Yb(139,"p",49),p.Cc(140),p.Xb(),p.Xb(),p.Yb(141,"div",47),p.Yb(142,"p",48),p.Cc(143,"Valor ICE"),p.Xb(),p.Yb(144,"p",49),p.Cc(145),p.Xb(),p.Xb(),p.Yb(146,"div",47),p.Yb(147,"p",48),p.Cc(148,"Valor IRBPNR"),p.Xb(),p.Yb(149,"p",49),p.Cc(150,"0.00"),p.Xb(),p.Xb(),p.Yb(151,"div",47),p.Yb(152,"p",48),p.Cc(153,"IVA 12%"),p.Xb(),p.Yb(154,"p",49),p.Cc(155),p.Xb(),p.Xb(),p.Yb(156,"div",47),p.Yb(157,"p",48),p.Cc(158,"Propina"),p.Xb(),p.Yb(159,"p",49),p.Cc(160,"0.00"),p.Xb(),p.Xb(),p.Yb(161,"div",47),p.Yb(162,"p",50),p.Cc(163," VALOR TOTAL "),p.Xb(),p.Yb(164,"p",49),p.Cc(165),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(166,"div",51),p.Yb(167,"button",52),p.Ub(168,"i",53),p.Cc(169," Guardar "),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.uc(5),t=p.uc(42),c=p.uc(49),o=p.uc(72);p.Jb(13),p.mc("checked",i.isNewSupplier),p.Jb(8),p.mc("ngModel",i.supplier.PRO_TIPOIDE),p.Jb(2),p.mc("ngForOf",i.typeClient),p.Jb(6),p.mc("ngModel",i.supplier.PRO_CODIGO),p.Jb(4),p.mc("ngIf",0==i.isNewSupplier),p.Jb(1),p.mc("ngIf",i.isNewSupplier),p.Jb(7),p.mc("ngModel",i.supplier.PRO_NOMBRE),p.Jb(2),p.mc("ngIf",e.submitted&&t.invalid),p.Jb(5),p.mc("ngModel",i.supplier.PRO_NOMBREC),p.Jb(2),p.mc("ngIf",e.submitted&&c.invalid),p.Jb(7),p.mc("ngModel",i.supplier.PRO_DIRECCION1),p.Jb(5),p.mc("ngModel",i.supplier.PRO_TELEFONO1),p.Jb(5),p.mc("ngModel",i.supplier.PRO_CORREO),p.Jb(4),p.mc("ngModel",i.invoice.ENCFACPRO_NUMERO),p.Jb(2),p.mc("ngIf",e.submitted&&o.invalid),p.Jb(30),p.mc("ngForOf",i.invoice.itemsInvoice),p.Jb(12),p.Dc(i.subtotal.toFixed(2)),p.Jb(5),p.Ec(" ",i.invoice.ENCFACPRO_BASEIVA.toFixed(2)," "),p.Jb(5),p.Ec(" ",i.invoice.ENCFACPRO_BASECERO.toFixed(2)," "),p.Jb(5),p.Ec(" ",i.invoice.ENCFACPRO_BASENOOBJIVA.toFixed(2)," "),p.Jb(5),p.Ec(" ",i.invoice.ENCFACPRO_PORCEIVA.toFixed(2)," "),p.Jb(5),p.Ec(" ",i.invoice.ENCFACPRO_PORCEDES.toFixed(2)," "),p.Jb(5),p.Ec(" ",i.invoice.ENCFACPRO_VALORICE.toFixed(2)," "),p.Jb(10),p.Ec(" ",i.invoice.ENCFACPRO_VALORIVA.toFixed(2)," "),p.Jb(10),p.Ec(" ",i.invoice.ENCFACPRO_TOTAL.toFixed(2)," ")}},directives:[o.n,o.f,o.g,o.l,o.e,o.h,n.j,o.a,o.c,o.k,n.k,o.d,o.i,o.o,o.j],styles:[""]}),e})()}];let se=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=p.Rb({type:e}),e.\u0275inj=p.Qb({imports:[[r.f.forChild(le)],r.f]}),e})(),ae=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=p.Rb({type:e}),e.\u0275inj=p.Qb({imports:[[n.b,se,o.b,c.f]]}),e})()}}]);